<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Our Discord üí¨üíò</title>
  <style>
    :root{
      --bg:#313338; --serverbar:#1e1f22; --sidebar:#2b2d31; --chat:#313338; --panel:#232428;
      --text:#dbdee1; --muted:#b5bac1; --accent:#5865f2; --outline:rgba(255,255,255,0.08);
      --shadow:rgba(0,0,0,0.35);
    }
    *{box-sizing:border-box}
    body{
      margin:0;height:100vh;overflow:hidden;background:var(--bg);color:var(--text);
      font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;
    }
    .app{display:flex;height:100vh;width:100vw}

    /* Servers bar */
    .servers{
      width:72px;background:var(--serverbar);padding:10px 0;display:flex;flex-direction:column;
      align-items:center;gap:10px;overflow-y:auto;
    }
    .serverDot{
      width:48px;height:48px;border-radius:24px;display:flex;align-items:center;justify-content:center;
      background:#313338;color:var(--text);font-weight:950;letter-spacing:.4px;
      border:1px solid rgba(255,255,255,.06);cursor:pointer;user-select:none;
      transition:border-radius .15s ease,background .15s ease,transform .1s ease;position:relative;
    }
    .serverDot:hover{border-radius:16px;background:#3a3c43;transform:translateY(-1px)}
    .serverDot.active{border-radius:16px;background:var(--accent);border-color:rgba(255,255,255,.12)}
    .pill{position:absolute;left:-10px;width:6px;height:18px;border-radius:999px;background:#fff;opacity:0;transition:opacity .15s ease,height .15s ease}
    .serverDot.active .pill{opacity:1;height:30px}
    .divider{width:32px;height:2px;background:rgba(255,255,255,.08);margin:4px 0;border-radius:999px}

    /* Sidebar */
    .sidebar{
      width:260px;background:var(--sidebar);display:flex;flex-direction:column;border-right:1px solid var(--outline);
    }
    .sidebarTop{
      height:48px;display:flex;align-items:center;padding:0 12px;background:var(--panel);
      border-bottom:1px solid var(--outline);gap:10px;
    }
    .serverTitle{font-weight:950;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex:1}
    .sideBtn{
      background:transparent;border:1px solid rgba(255,255,255,.10);color:var(--text);
      border-radius:10px;padding:6px 10px;cursor:pointer;font-weight:950;
    }
    .sideBtn:hover{border-color:rgba(255,255,255,.18)}
    .channels{padding:10px 8px;overflow-y:auto}
    .cat{
      margin:10px 8px 6px;font-size:12px;font-weight:950;color:var(--muted);
      text-transform:uppercase;letter-spacing:.06em;
    }
    .chan{
      padding:8px 10px;border-radius:8px;margin:2px 6px;cursor:pointer;color:var(--muted);
      display:flex;align-items:center;gap:8px;user-select:none
    }
    .chan:hover{background:rgba(255,255,255,.06);color:var(--text)}
    .chan.active{background:rgba(255,255,255,.10);color:var(--text)}
    .hash{opacity:.85}

    /* Chat */
    .chat{flex:1;display:flex;flex-direction:column;background:var(--chat);min-width:0}
    .chatTop{
      height:48px;display:flex;align-items:center;gap:10px;padding:0 12px;background:var(--panel);
      border-bottom:1px solid var(--outline);
    }
    .channelTitle{font-weight:950}
    .subtle{color:var(--muted);font-size:12px;margin-left:6px}
    .chatBody{flex:1;overflow-y:auto;padding:14px 14px 120px}

    .card{
      background:rgba(0,0,0,.22);border:1px solid rgba(255,255,255,.08);border-radius:14px;
      box-shadow:0 18px 40px var(--shadow);padding:14px;margin:10px 0;
    }
    .row{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
    .badge{
      display:inline-flex;align-items:center;gap:8px;padding:8px 10px;border-radius:999px;
      background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.10);
      color:var(--text);font-weight:950;font-size:13px;
    }
    .btn{
      border:none;cursor:pointer;font-weight:950;border-radius:12px;padding:10px 12px;color:var(--text);
      background:rgba(255,255,255,.10);border:1px solid rgba(255,255,255,.12);
    }
    .btn:hover{background:rgba(255,255,255,.14)}
    .btnAccent{background:var(--accent);border-color:rgba(255,255,255,.14)}
    .btnAccent:hover{filter:brightness(1.05)}

    /* Slideshow */
    .slideWrap{
      position:relative;width:min(520px,100%);aspect-ratio:3/4;border-radius:14px;overflow:hidden;
      border:1px solid rgba(255,255,255,.12);background:rgba(255,255,255,.06);
      cursor:pointer;user-select:none;touch-action:manipulation;
    }
    .slideWrap img{
      position:absolute;inset:0;width:100%;height:100%;object-fit:cover;opacity:0;
      transition:opacity .55s ease;
    }
    .slideWrap img.active{opacity:1}
    .placeholder{
      position:absolute;inset:0;display:flex;align-items:center;justify-content:center;padding:14px;
      color:var(--muted);font-weight:950;text-align:center;line-height:1.5;
    }
    .mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,monospace;font-size:12px}
    @media (max-width:860px){.sidebar{display:none}}
  </style>
</head>

<body>
  <div class="app">
    <div class="servers" id="servers">
      <div class="serverDot active" data-server="y22"><span class="pill"></span>22</div>
      <div class="serverDot" data-server="y23"><span class="pill"></span>23</div>
      <div class="serverDot" data-server="y24"><span class="pill"></span>24</div>
      <div class="serverDot" data-server="y25"><span class="pill"></span>25</div>
      <div class="serverDot" data-server="y26"><span class="pill"></span>26</div>
      <div class="divider"></div>
      <div class="serverDot" data-server="game"><span class="pill"></span>üéÆ</div>
    </div>

    <div class="sidebar">
      <div class="sidebarTop">
        <div class="serverTitle" id="serverTitle">2022</div>
        <button class="sideBtn" id="musicBtn" title="Toggle music">üîä</button>
      </div>
      <div class="channels">
        <div class="cat">Memories</div>
        <div class="chan active" data-chan="slideshow"><span class="hash">#</span>slideshow</div>
        <div class="cat">Special</div>
        <div class="chan" data-chan="valentine"><span class="hash">#</span>valentine</div>
        <div class="chan" data-chan="debug"><span class="hash">#</span>debug</div>
      </div>
    </div>

    <div class="chat">
      <div class="chatTop">
        <div class="channelTitle" id="channelTitle">#slideshow</div>
        <div class="subtle" id="channelHint">Tap photo to go next ‚Ä¢ auto plays</div>
      </div>
      <div class="chatBody" id="chatBody"></div>
    </div>
  </div>

  <!-- music -->
  <audio id="music" loop>
    <source src="song.mp3" type="audio/mpeg" />
  </audio>

<script>
/* =======================
   CONFIG (your repo)
======================= */
const SITE_VERSION = "DISCORD REVAMP ‚Äî IMAGE RAW FIX (SHOULD SHOW PHOTOS)";
const RAW_BASE = "https://raw.githubusercontent.com/manassehbonaparte-spec/https-manasseh.github.io-our-love-story/main/";

/* Base names ONLY (no extensions) */
const IMAGES = {
  y22: ["22_01","22_02","22_03","22_04","22_05","22_06"],
  y23: ["23_01","23_02","23_03","23_04","23_05","23_06"],
  y24: ["24_01","24_02","24_03","24_04","24_05","24_06","24_07","24_08"],
  y25: ["25_01","25_02","25_03","25_04","25_05","25_06","25_07","25_08","25_09"],
  y26: [
    "456C3DFA-6694-47CD-9340-C41EDA179452",
    "9779781B-6837-46AD-8A78-09F7AD151B48",
    "EE0C9E1C-9B92-4CEC-91BF-210B3D5DB6D5"
  ]
};

const EXT_TRIES = [".JPEG",".JPG",".PNG",".jpeg",".jpg",".png",".Jpeg",".JPeg",".Png",".jPEG",".jPg",".pNg"];

/* =======================
   STATE
======================= */
let currentServer = "y22";
let currentChan = "slideshow";

/* =======================
   HELPERS
======================= */
const chatBody = document.getElementById("chatBody");
const serverTitle = document.getElementById("serverTitle");
const channelTitle = document.getElementById("channelTitle");
const channelHint = document.getElementById("channelHint");

function serverLabel(id){
  if (id === "game") return "Game";
  return "20" + id.slice(1);
}
function setHeader(){
  serverTitle.textContent = serverLabel(currentServer);
  channelTitle.textContent = "#" + currentChan;
  if (currentChan === "debug") channelHint.textContent = "This shows which image URLs are found.";
  else if (currentServer === "y22" && currentChan === "valentine") channelHint.textContent = "Timers + music live here.";
  else channelHint.textContent = "Tap photo to go next ‚Ä¢ auto plays";
}

function setActiveServerUI(){
  document.querySelectorAll(".serverDot").forEach(el => el.classList.toggle("active", el.dataset.server === currentServer));
}
function setActiveChanUI(){
  document.querySelectorAll(".chan").forEach(el => el.classList.toggle("active", el.dataset.chan === currentChan));
}

/* =======================
   MUSIC
======================= */
const music = document.getElementById("music");
const musicBtn = document.getElementById("musicBtn");
let musicOn = true;

function syncMusicIcon(){ musicBtn.textContent = musicOn ? "üîä" : "üîá"; }
syncMusicIcon();

async function bootMusic(){
  try { if (musicOn) await music.play(); } catch {}
}
window.addEventListener("pointerdown", bootMusic, { once:true });

musicBtn.addEventListener("click", async () => {
  musicOn = !musicOn;
  if (!musicOn){
    music.pause(); music.currentTime = 0;
  } else {
    try { await music.play(); } catch {}
  }
  syncMusicIcon();
});

/* =======================
   TIMERS (22)
======================= */
const TARGET_2027 = new Date("February 25, 2027 00:00:00").getTime();
function targetThisYear(){
  const y = new Date().getFullYear();
  return new Date(`February 25, ${y} 00:00:00`).getTime();
}
function countdownText(targetMs){
  const now = Date.now();
  const d = targetMs - now;
  if (d <= 0) return "It‚Äôs today ‚ù§Ô∏è";
  const days = Math.floor(d/(1000*60*60*24));
  const hours = Math.floor((d/(1000*60*60))%24);
  const mins = Math.floor((d/(1000*60))%60);
  const secs = Math.floor((d/1000)%60);
  return `${days}d ${hours}h ${mins}m ${secs}s`;
}

/* =======================
   SLIDESHOW LOADING (RAW)
======================= */
function resolveFirstWorkingSrc(base){
  return new Promise((resolve) => {
    let idx = 0;
    const test = () => {
      if (idx >= EXT_TRIES.length) return resolve(null);
      const src = RAW_BASE + base + EXT_TRIES[idx];
      const img = new Image();
      img.onload = () => resolve(src);
      img.onerror = () => { idx++; test(); };
      img.src = src;
    };
    test();
  });
}

async function buildSlideshow(baseNames){
  const wrap = document.createElement("div");
  wrap.className = "slideWrap";

  const resolved = [];
  for (const b of (baseNames || [])){
    const src = await resolveFirstWorkingSrc(b);
    if (src) resolved.push(src);
  }

  if (resolved.length === 0){
    wrap.innerHTML = `
      <div class="placeholder">
        No images loaded.<br/>
        That means RAW urls for these names weren‚Äôt found.<br/>
        Go to <b>#debug</b> to see which ones fail.
      </div>
    `;
    return { wrap, start: () => {} };
  }

  const imgs = resolved.map((src, i) => {
    const im = document.createElement("img");
    im.src = src;
    if (i === 0) im.classList.add("active");
    wrap.appendChild(im);
    return im;
  });

  let i = 0;
  const show = (n) => {
    imgs[i].classList.remove("active");
    i = (n + imgs.length) % imgs.length;
    imgs[i].classList.add("active");
  };
  const next = () => show(i + 1);
  const prev = () => show(i - 1);

  let timer = null;
  const start = () => {
    clearInterval(timer);
    timer = setInterval(next, 3000);
  };

  wrap.addEventListener("click", () => { next(); start(); });

  // swipe
  let startX = null;
  wrap.addEventListener("touchstart", (e) => { startX = e.touches?.[0]?.clientX ?? null; }, {passive:true});
  wrap.addEventListener("touchend", (e) => {
    if (startX === null) return;
    const endX = e.changedTouches?.[0]?.clientX ?? startX;
    const dx = endX - startX;
    startX = null;
    if (Math.abs(dx) < 35) return;
    if (dx < 0) next(); else prev();
    start();
  });

  return { wrap, start };
}

/* =======================
   DEBUG LIST
======================= */
async function buildDebugPanel(baseNames){
  const card = document.createElement("div");
  card.className = "card";
  card.innerHTML = `<div style="font-weight:1000;">Image Debug</div>
  <div style="margin-top:6px;color:var(--muted);font-weight:900;">It will show ‚úÖ for files it finds on RAW.</div>
  <div id="dbg" class="mono" style="margin-top:10px;line-height:1.6;"></div>`;
  const dbg = card.querySelector("#dbg");

  for (const b of (baseNames || [])){
    let found = null;
    for (const ext of EXT_TRIES){
      const url = RAW_BASE + b + ext;
      try{
        const r = await fetch(url, { method:"HEAD", cache:"no-store" });
        if (r.ok){ found = url; break; }
      } catch {}
    }
    if (found) dbg.innerHTML += `‚úÖ ${found}<br/>`;
    else dbg.innerHTML += `‚ùå ${b} (not found with any extension)<br/>`;
  }
  return card;
}

/* =======================
   RENDER
======================= */
function makeCard(html){
  const d = document.createElement("div");
  d.className = "card";
  d.innerHTML = html;
  return d;
}

async function render(){
  chatBody.innerHTML = "";
  setHeader();

  // Version card
  chatBody.appendChild(makeCard(`
    <div style="font-weight:1000;">${SITE_VERSION}</div>
    <div style="margin-top:6px;color:var(--muted);font-weight:900;">
      If you can see this, your site updated correctly.
    </div>
  `));

  // game placeholder (so it isn't blank)
  if (currentServer === "game"){
    chatBody.appendChild(makeCard(`
      <div style="font-weight:1000;font-size:18px;">üéÆ Game Server</div>
      <div style="margin-top:6px;color:var(--muted);font-weight:900;line-height:1.6;">
        The game can be re-added after photos are confirmed working.<br/>
        Right now this build is focused on making your images show 100%.
      </div>
    `));
    return;
  }

  // 22 valentine channel
  if (currentServer === "y22" && currentChan === "valentine"){
    const c = makeCard(`
      <div style="font-weight:1000; font-size:18px;">Will you be my Valentine? üíò</div>
      <div class="row" style="margin-top:10px;">
        <span class="badge">‚ù§Ô∏è Feb 25: <span id="cd1"></span></span>
        <span class="badge">üíç Feb 25, 2027: <span id="cd2"></span></span>
      </div>
      <div class="row" style="margin-top:12px;">
        <button class="btn btnAccent" id="musicToggle22">‚ñ∂ Play / Pause Music</button>
      </div>
    `);
    chatBody.appendChild(c);

    const update = () => {
      const cd1 = document.getElementById("cd1");
      const cd2 = document.getElementById("cd2");
      if (cd1) cd1.textContent = countdownText(targetThisYear());
      if (cd2) cd2.textContent = countdownText(TARGET_2027);
    };
    update();
    setInterval(update, 1000);

    document.getElementById("musicToggle22").addEventListener("click", async () => {
      if (music.paused){ try { await music.play(); } catch {} }
      else music.pause();
    });

    const {wrap, start} = await buildSlideshow(IMAGES.y22);
    const pics = makeCard(`<div style="font-weight:1000; margin-bottom:10px;">2022 slideshow</div>`);
    pics.appendChild(wrap);
    chatBody.appendChild(pics);
    start();
    return;
  }

  // debug channel
  if (currentChan === "debug"){
    chatBody.appendChild(makeCard(`
      <div style="font-weight:1000;">Debug for ${serverLabel(currentServer)}</div>
      <div style="margin-top:6px;color:var(--muted);font-weight:900;">
        This lists the exact RAW URLs it can (or cannot) find.
      </div>
    `));
    chatBody.appendChild(await buildDebugPanel(IMAGES[currentServer]));
    return;
  }

  // default slideshow
  chatBody.appendChild(makeCard(`
    <div style="font-weight:1000;font-size:18px;">${serverLabel(currentServer)} memories üì∏</div>
    <div style="margin-top:6px;color:var(--muted);font-weight:900;">Auto-play slideshow + tap/click for next</div>
  `));

  const {wrap, start} = await buildSlideshow(IMAGES[currentServer]);
  const pics = makeCard(`<div style="font-weight:1000; margin-bottom:10px;">Slideshow</div>`);
  pics.appendChild(wrap);
  chatBody.appendChild(pics);
  start();
}

/* =======================
   NAV EVENTS
======================= */
document.getElementById("servers").addEventListener("click", (e) => {
  const dot = e.target.closest(".serverDot");
  if (!dot) return;
  currentServer = dot.dataset.server;
  currentChan = (currentServer === "y22") ? "valentine" : "slideshow";
  setActiveServerUI();
  setActiveChanUI();
  render();
});

document.querySelectorAll(".chan").forEach(el => {
  el.addEventListener("click", () => {
    currentChan = el.dataset.chan;
    setActiveChanUI();
    render();
  });
});

/* boot */
setActiveServerUI();
setActiveChanUI();
render();
</script>
</body>
</html>





